# Portfolio Manager Environment Configuration
# Copy this file to .env and customize for your environment
#
# This project uses Podman as the container runtime.
# All commands use native 'podman compose' (Podman v4.0+).

# ===== Database Configuration =====
# PostgreSQL creates two databases automatically via init-db.sh:
# 1. portfolio_db - Your application data
# 2. authentik - Authentik authentication system data
POSTGRES_DB=portfolio_db
POSTGRES_USER=portfolio_user
POSTGRES_PASSWORD=portfolio_pass

# Backend connects to portfolio_db for application data
DB_HOST=localhost
DB_PORT=5432
DB_NAME=portfolio_db
DB_USER=portfolio_user
DB_PASSWORD=portfolio_pass
DB_SSLMODE=disable
DB_TIMEZONE=UTC

# ===== Authentik Configuration =====
# Generate a secure random key: openssl rand -base64 60
AUTHENTIK_SECRET_KEY=change-me-to-a-random-string-min-50-characters-long

# Authentik uses a separate database (created automatically by init-db.sh)
AUTHENTIK_DB_NAME=authentik
AUTHENTIK_LOG_LEVEL=info
AUTHENTIK_PORT=9000
AUTHENTIK_HTTPS_PORT=9443

# OAuth2/OIDC Configuration (Set after creating Authentik application)
# See AUTHENTIK_SETUP.md for detailed instructions
AUTHENTIK_ISSUER=http://localhost:9000/application/o/portfolio-manager/
AUTHENTIK_CLIENT_ID=portfolio-manager
AUTHENTIK_CLIENT_SECRET=your-client-secret-from-authentik

# ===== Backend API Configuration =====
PORT=8000
LOG_LEVEL=info
GIN_MODE=debug
NODE_ENV=production

# ===== Frontend Configuration =====
FRONTEND_PORT=3000
VITE_API_URL=http://localhost:8000/api
VITE_AUTHENTIK_URL=http://localhost:9000
VITE_AUTHENTIK_REDIRECT_URI=http://localhost:3000/auth/callback

# For testing mode (bypasses Authentik auth)
# TESTING_MODE=true

# ===== Security Configuration =====
# CORS - Comma-separated list of allowed origins (use * for dev, specific domains for prod)
ALLOWED_ORIGINS=http://localhost:3000

# Rate Limiting
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60

# Request Size Limit (in bytes, default 10MB)
MAX_REQUEST_SIZE=10485760

# Prometheus Metrics Authentication
PROMETHEUS_AUTH_USER=admin
PROMETHEUS_AUTH_PASSWORD=changeme-secure-password

# ===== Database Security =====
DB_QUERY_TIMEOUT=30
DB_LOG_LEVEL=info
DB_MAX_IDLE_CONNS=10
DB_MAX_OPEN_CONNS=100
DB_CONN_MAX_LIFETIME=1h
DB_CONN_MAX_IDLE_TIME=10m

# ===== Monitoring (Optional) =====
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin
GRAFANA_PORT=3001
GF_USERS_ALLOW_SIGN_UP=false
PROMETHEUS_PORT=9090

# ===== Database UI (Optional - Adminer) =====
# Adminer provides a lightweight web-based database management interface
# Supports PostgreSQL, MySQL, MongoDB, and more (perfect for microservices ecosystem)
# Start with: make db-ui-start
# Access at: http://localhost:8080
ADMINER_PORT=8080
ADMINER_DESIGN=nette  # Options: nette, pepa-linha, pepa-linha-dark, price, hydra

# ===== Notes =====
# 1. Generate AUTHENTIK_SECRET_KEY with: openssl rand -base64 60
# 2. After starting Authentik, follow AUTHENTIK_SETUP.md to get CLIENT_SECRET
# 3. Never commit .env file to version control
# 4. Use strong passwords in production
# 5. Enable HTTPS in production and update all URLs accordingly
